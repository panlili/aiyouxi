<div>
    <a class="adddonater" href="#">添加捐赠人</a>
</div>
<table class="common_table">
    <thead>
    <th>编号</th>
    <th>捐赠人姓名</th>
    <th>联系电话</th>
    <th>性别</th>
    <th>备注</th>
    <th>添加时间</th>
    <th>更新时间</th> 
    <th>状态</th>
</thead>
<tbody>
<volist name="donater" id="each">
    <tr id="{$each.id}">
        <td>{$each.serial}</td>
        <td>{$each.name}</td>
        <td>{$each.phone}</td>
        <td>{$each.sex}</td>
        <td>{$each.comment}</td>
        <td>{$each.addtime|date="Y-m-d,H:m:s",###}</td>
        <td>{$each.uptime|date="Y-m-d,H:m:s",###}</td>        
        <td><a class="status" href="#" onclick="toggle_status('__APP__/Donater/changeStatus','{$each.id}');return false;">{$each.status|get_status_str_by_int}</a></td>
    </tr>
</volist>
</tbody>
</table>

<div id="adduserForm">
    <form class="common_form">
        <table width="100%" border="0" class="formtable1">
            <tr>
                <td><label>编号</label></td><td>
                    <input type="text" name="serial" id="serial" class="inputstyle1"/>
                </td>
            </tr>
            <tr>
                <td><label>捐赠人姓名</label></td><td>
                    <input type="text" name="name" id="name" class="inputstyle1"/></td>
            </tr>
            <tr>
                <td><label>联系电话</label></td><td>
                    <input type="text" name="phone" id="phone" class="inputstyle1"/></td>
            </tr>
            <tr>
                <td><label>性别</label></td><td>
                    <select name="sex" class="inputstyle1">
                        <option value="男">男</option>
                        <option value="女">女</option>
                    </select></td>
            </tr>
            <tr>
                <td><label>备注</label></td><td>
                    <textarea name="comment" cols="" rows="5" wrap="virtual" class="inputstyle1"></textarea></td>
            </tr>

        </table>
        <input id="reset" type="reset" style="display: none"/>
    </form>
</div>

<script type="text/javascript">
    $(function(){
        //添加用户的dialog
        var $dialog=$("#adduserForm").dialog({
            autoOpen:false,
            title: "添加新捐赠人",
            modal: true,
            width:400,
            close: function() {
                $('#reset').click()
            },
            buttons: {
                添加捐赠人: function(){
                    add_user("__APP__/Donater/add",$("#adduserForm .common_form").serialize());
                },
                取消: function() {
                    $( this ).dialog( "close" );
                }
            }
        });

        $('.adddonater').click(function() {
            $dialog.dialog('open');
            // prevent the default action, e.g., following a link
            return false;
        });

        //更新用户状态的提示信息框
        $("a.status").qtip({
            content: {
                text:function(){
                    return $(this).text()=="启用中"?"点击禁用捐赠人":"点击启用捐赠人";
                }
            },
            position: {
                my: 'top left',
                at: 'bottom right'
            }
        });
    });
</script>